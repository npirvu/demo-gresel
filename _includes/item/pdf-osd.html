<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>PDF Viewer con OpenSeadragon</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.0/openseadragon.min.js"></script>

<style>
  #osd {
    width: 100%;
    height: 800px;
    border: 1px solid #88ea1230;
    background: #171717;
  }

  #osd-controls {
    display: flex;
    align-items: center;
    gap: 0.25em;
    padding: 0.25em;
    background: #1f1f1f;
    border: 1px solid #333;
    border-radius: 6px;
    margin-bottom: 0.4em;
  }

  #osd-controls button {
    background: #2a2a2a;
    color: #eee;
    border: 1px solid #444;
    padding: 0.15em 0.4em;
    font-size: 0.8em;
    line-height: 1;
    border-radius: 4px;
    cursor: pointer;
  }

  #osd-controls button:hover {
    background: #3a3a3a;
  }

  #page-indicator {
    color: #bbb;
    font-size: 0.75em;
    margin-left: auto;
  }

  .article-segment.article-hover {
    border: 2px solid rgba(96, 132, 5, 0.457);
    background: rgba(127, 175, 7, 0.463);
  }

  .article-segment.active {
    border-color: rgba(31, 135, 0, 0.523);
    background: rgba(27, 108, 2, 0.423);
  }

  #article-buttons button {
    display: block;
    width: 100%;
    padding: 0.3em 0.6em;    
    margin-bottom: 0.15em;
    text-align: left;
    background: rgba(234, 238, 225, 0.85);
    border: 1px solid rgba(84, 114, 6, 0.35);
    border-radius: 3px;
    cursor: pointer;
    font-weight: 500;       
    font-size: 0.85em;      
    line-height: 1.2;
  }

  #article-buttons button:hover {
    background: rgba(210, 220, 190, 0.9);
  }

  .article-content {
    white-space: pre-wrap;
    max-height: 0px;          
    overflow-y: auto;           
    overflow-x: hidden;         
    opacity: 0;
    padding: 0 1em;
    border-left: 3px solid rgba(131, 232, 0, 0.341);
    text-align: left;
    font-size: 0.85em;
    line-height: 1.4;
    transition:
      max-height 0.35s ease,
      opacity 0.25s ease,
      padding 0.25s ease;
  }

  .article-content.open {
    max-height: 500px;           
    opacity: 1;
    padding: 0.5em 1em;
  }
</style>
</head>
<body>

<div id="osd-controls">
  <button id="prev-page">Anterior</button>
  <button id="next-page">Siguiente</button>
  <span id="page-indicator">Página 1 / N</span>
</div>

<div id="osd"></div>

<h3>Transcripciones OCR</h3>
<div id="article-buttons"></div>

<script>
const PDF_INDEX_JSON = "pdfs-index.json"; // JSON con todos los PDFs y páginas
let pdfIndex = [];
let currentPdfIndex = 0;
let currentPages = [];
let currentPage = 0;
let viewer;

// ================================
// INIT
// ================================
async function init() {
  pdfIndex = await (await fetch(PDF_INDEX_JSON)).json();
  loadPdf(pdfIndex[currentPdfIndex]);
}

// ================================
// CARGAR PDF
// ================================
async function loadPdf(pdfData) {
  currentPages = pdfData.pages;
  currentPage = 0;

  if(!viewer) {
    viewer = OpenSeadragon({
      id: "osd",
      prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
      showNavigator: true
    });
  }

  document.getElementById("prev-page").onclick = () => {
    if(currentPage > 0) loadPage(currentPage - 1);
  };

  document
